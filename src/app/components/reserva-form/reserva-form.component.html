<div class="container">

  @if (espacioSeleccionado) {

    <!-- HERO DEL ESPACIO -->
    <section class="espacio-hero">

      <img
        *ngIf="espacioSeleccionado.imagen1"
        class="hero-image"
        [src]="apiUrl + espacioSeleccionado.imagen1"
        alt="{{ espacioSeleccionado.titulo }}"
      />

      <div class="hero-info">
        <h2 class="title">{{ espacioSeleccionado.titulo }}</h2>
        <span class="pax">Capacidad: {{ espacioSeleccionado.tipo_espacio.capacidad }} personas</span>
      </div>

    </section>

    <!-- DESCRIPCIÓN -->
    <section
      class="descripcion"
      *ngIf="espacioSeleccionado.tipo_espacio.descripcion"
    >
      {{ espacioSeleccionado.tipo_espacio.descripcion }}
    </section>

    <!-- GALERÍA SIMPLE -->
    <section class="galeria" *ngIf="
      espacioSeleccionado.imagen2 || espacioSeleccionado.imagen3
    ">
      <img
        *ngIf="espacioSeleccionado.imagen2"
        [src]="apiUrl + espacioSeleccionado.imagen2"
        alt="Imagen secundaria"
      />
      <img
        *ngIf="espacioSeleccionado.imagen3"
        [src]="apiUrl + espacioSeleccionado.imagen3"
        alt="Imagen secundaria"
      />
    </section>

  }

  <!-- FORMULARIO -->
  <form [formGroup]="form" (ngSubmit)="submit()" class="form">

    <div class="grid">

      <mat-form-field appearance="outline">
        <mat-label>Nombre</mat-label>
        <input matInput formControlName="nombre" />
        <mat-error *ngIf="form.get('nombre')?.hasError('required')">
          El nombre es obligatorio
        </mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>PAX</mat-label>
        <input matInput type="number" formControlName="pax" />
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Check-in</mat-label>
        <input
          matInput
          [matDatepicker]="pickerCheckin"
          [matDatepickerFilter]="dateFilter"
          formControlName="checkin"
        />
        <mat-datepicker-toggle matSuffix [for]="pickerCheckin" />
        <mat-datepicker #pickerCheckin [dateClass]="dateClass" />
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Check-out</mat-label>
        <input
          matInput
          [matDatepicker]="pickerCheckout"
          [matDatepickerFilter]="dateFilter"
          formControlName="checkout"
        />
        <mat-datepicker-toggle matSuffix [for]="pickerCheckout" />
        <mat-datepicker #pickerCheckout [dateClass]="dateClass" />
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Teléfono</mat-label>
        <input matInput formControlName="telefono" />
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Email</mat-label>
        <input matInput type="email" formControlName="email" />
      </mat-form-field>

      <mat-form-field appearance="outline" class="full">
        <mat-label>Observaciones</mat-label>
        <textarea matInput rows="3" formControlName="observaciones"></textarea>
      </mat-form-field>

    </div>

    @if (cotizacion) {
      <section class="resumen">
        <h3>Resumen de la estadía</h3>
    
        <div class="linea" *ngFor="let item of cotizacion.detalle">
          <span>
            {{ item.cantidad }}
            {{ item.tipo === 'DIA' ? 'día(s)' : 'noche(s)' }}
          </span>
          <span>
            {{ item.precio_unitario | currency:'ARS' }}
          </span>
          <strong>
            {{ item.subtotal | currency:'ARS' }}
          </strong>
        </div>
    
        <div class="total">
          Total:
          <strong>{{ cotizacion.total | currency:'ARS' }}</strong>
        </div>
      </section>
    }    

    <div class="actions">
      <button mat-raised-button type="button" (click)="goBack()">
        Volver
      </button>
      <button mat-raised-button color="primary" type="submit" [disabled]="form.invalid">
        Guardar reserva
      </button>
    </div>

  </form>

</div>
